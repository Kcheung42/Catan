{"version":3,"sources":["catan_board/utils/hex.cljs"],"mappings":"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","names":["catan-board.utils.hex/sqrt3","Math/sqrt","catan-board.utils.hex/hex-directions","p__19186","vec__19187","cljs.core.nth","catan-board.utils.hex/axial-to-pixel","q","r","hex-size","x","y","p__19190","vec__19191","catan-board.utils.hex/pixel-to-axial","vec__19194","s","rq","Math/round","rr","rs","q-diff","Math/abs","r-diff","s-diff","final-q","final-r","p__19197","p__19198","vec__19199","vec__19202","catan-board.utils.hex/hex-add","q1","r1","q2","r2","catan-board.utils.hex/hex-neighbors","hex","p1__19205#","cljs.core.map","p__19206","p__19207","vec__19208","vec__19211","catan-board.utils.hex/hex-distance","s1","s2","catan-board.utils.hex/generate-catan-grid","coords","iter__5480__auto__","s__19215","cljs.core/LazySeq","temp__5804__auto__","cljs.core/seq","xs__6360__auto__","cljs.core/first","iterys__5476__auto__","s__19217","cljs.core/chunked-seq?","c__5478__auto__","size__5479__auto__","cljs.core/count","b__19219","cljs.core/chunk-buffer","i__19218","cljs.core/-nth","cljs.core/chunk-append","cljs.core/chunk-cons","cljs.core/chunk","iter__19216","cljs.core/chunk-rest","cljs.core/cons","cljs.core/rest","fs__5477__auto__","cljs.core.concat","iter__19214","cljs.core.range","cljs.core/vec","p__19220","vec__19221","catan-board.utils.hex/hex-vertices","vec__19224","cx","cy","s__19228","b__19230","i__19229","iter__19227","i","angle","Math/PI","Math/cos","Math/sin","catan-board.utils.hex/vertices-to-svg-points","vertices","p__19231","vec__19232","clojure.string.join","catan-board.utils.hex/hex-center","coord","cljs.core/chunk-first"],"sourcesContent":["(ns catan-board.utils.hex\n  \"Hexagonal grid utilities using axial coordinates (q, r).\n   Based on Red Blob Games hexagon guide for flat-top hexagons.\")\n\n;; -- Constants ---------------------------------------------------------------\n\n(def sqrt3 (Math/sqrt 3))\n\n;; Axial direction vectors for the 6 neighbors of a hex\n(def hex-directions\n  [[1 0]   ; right\n   [1 -1]  ; up-right\n   [0 -1]  ; up-left\n   [-1 0]  ; left\n   [-1 1]  ; down-left\n   [0 1]]) ; down-right\n\n;; -- Coordinate Conversion ---------------------------------------------------\n\n(defn axial-to-pixel\n  \"Converts axial coordinates [q r] to pixel coordinates [x y] for flat-top hexagons.\n   hex-size is the distance from center to any vertex (radius).\"\n  [[q r] hex-size]\n  (let [x (* hex-size (/ 3 2) q)\n        y (* hex-size (+ (* sqrt3 (/ 1 2) q)\n                         (* sqrt3 r)))]\n    [x y]))\n\n(defn pixel-to-axial\n  \"Converts pixel coordinates [x y] back to axial coordinates [q r].\n   Returns rounded axial coordinates.\"\n  [[x y] hex-size]\n  (let [q (/ (* (/ 2 3) x) hex-size)\n        r (/ (- y (* (/ sqrt3 3) x)) (* sqrt3 hex-size))\n        ;; Convert to cube coordinates for proper rounding\n        s (- (- q) r)\n        ;; Round to nearest integer coordinates\n        rq (Math/round q)\n        rr (Math/round r)\n        rs (Math/round s)\n        ;; Fix rounding errors\n        q-diff (Math/abs (- rq q))\n        r-diff (Math/abs (- rr r))\n        s-diff (Math/abs (- rs s))\n        [final-q final-r] (cond\n                            (and (> q-diff r-diff) (> q-diff s-diff))\n                            [(- (- rr) rs) rr]\n\n                            (> r-diff s-diff)\n                            [rq (- (- rq) rs)]\n\n                            :else\n                            [rq rr])]\n    [final-q final-r]))\n\n;; -- Hex Grid Operations -----------------------------------------------------\n\n(defn hex-add\n  \"Adds two axial coordinates.\"\n  [[q1 r1] [q2 r2]]\n  [(+ q1 q2) (+ r1 r2)])\n\n(defn hex-neighbors\n  \"Returns the 6 neighboring hexes of the given hex.\"\n  [hex]\n  (map #(hex-add hex %) hex-directions))\n\n(defn hex-distance\n  \"Calculates the distance between two hexes in hex steps.\n   Uses cube coordinate distance formula.\"\n  [[q1 r1] [q2 r2]]\n  (let [s1 (- (- q1) r1)\n        s2 (- (- q2) r2)]\n    (/ (+ (Math/abs (- q1 q2))\n          (Math/abs (- r1 r2))\n          (Math/abs (- s1 s2)))\n       2)))\n\n;; -- Catan Board Generation --------------------------------------------------\n\n(defn generate-catan-grid\n  \"Generates the standard Catan board layout with 20 hexes in a 3-4-5-4-3 pattern.\n   Returns a vector of axial coordinates.\"\n  []\n  (let [coords (for [q (range -2 3)\n                     r (range -2 3)\n                     :let [s (- (- q) r)]\n                     :when (and (>= s -2) (<= s 2))]\n                 [q r])]\n    (vec coords)))\n\n;; -- SVG Rendering Helpers ---------------------------------------------------\n\n(defn hex-vertices\n  \"Calculates the 6 vertex points of a flat-top hexagon.\n   Returns a vector of [x y] coordinates relative to the hex center.\n   Vertices are ordered clockwise starting from the rightmost point.\"\n  [[q r] hex-size]\n  (let [[cx cy] (axial-to-pixel [q r] hex-size)]\n    (for [i (range 6)]\n      (let [angle (* (/ Math/PI 3) i)  ; 60 degrees per vertex\n            x (+ cx (* hex-size (Math/cos angle)))\n            y (+ cy (* hex-size (Math/sin angle)))]\n        [x y]))))\n\n(defn vertices-to-svg-points\n  \"Converts a sequence of [x y] vertices to SVG points string format.\"\n  [vertices]\n  (->> vertices\n       (map (fn [[x y]] (str x \",\" y)))\n       (clojure.string/join \" \")))\n\n(defn hex-center\n  \"Returns the pixel coordinates [x y] of the hex center.\"\n  [coord hex-size]\n  (axial-to-pixel coord hex-size))\n"]}